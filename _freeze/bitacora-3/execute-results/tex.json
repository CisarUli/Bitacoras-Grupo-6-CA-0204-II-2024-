{
  "hash": "ec21bc4d5fa28fc526c7d187350a93df",
  "result": {
    "engine": "knitr",
    "markdown": "---\neditor: \n  markdown: \n    wrap: sentence\nexecute: \n  warning: FALSE\n  messages: FALSE\n---\n\n\n\n\n\n\n\n\n------------------------------------------------------------------------\n\n------------------------------------------------------------------------\n\n# Bitácora 3\n\n## Parte de Planificación\n\n### Análisis de Modelación\n\n#### Método #3: Modelo autorregresivo integrado de media móvil (ARIMA)\n\nComo se tienen los incidentes reportados por año y a su vez la suma de muertes, sobrevivientes y desaparecidos se puede proyectar el futuro número migrantes muertos, rescatados o desaparecidos en los próximos años. \n\nPrimero se cargan los datos recolectados del 2014 al 2022:\n\n\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(knitr)\nlibrary(countrycode)\n\nlista_archivos <- lapply(X = dir(path = \"data/\"), \n                         FUN = function(f){\n                           read_csv(paste0(\"data/\", f))\n                           })\nmigrantes_desaparecidos <- bind_rows(lista_archivos) |>\n  janitor::clean_names()\n\nmigrantes_desaparecidos <- migrantes_desaparecidos |>   #separate_wider_delim(col, delim)\n  separate(coordinates,\n           into = c(\"latitud\", \"longitud\"),\n           sep = \",\", fill = \"left\"\n           )\nmigrantes_desaparecidos$latitud <- as.numeric(migrantes_desaparecidos$latitud)\nmigrantes_desaparecidos$longitud <- as.numeric(migrantes_desaparecidos$longitud)#separa las coordenadas\n\nmigrantes_desaparecidos <- migrantes_desaparecidos |> #extrae la fecha exacta\n  mutate(incident_date = as.Date(\n    str_extract(incident_date,\n                \"\\\\b\\\\d{2}/\\\\d{2}/\\\\d{4}\\\\b\"), format = \"%m/%d/%Y\")\n    )\nmigrantes_desaparecidos <- migrantes_desaparecidos[ , -c(1, 6, 9, 16, 20:21)] #elimina la columna 1\nmigrantes_desaparecidos <- migrantes_desaparecidos |>\n  mutate(\n    location_of_death = str_remove_all(location_of_death, \" \\\\(see coordinates for exact location\\\\)\")\n    )\nmigrantes_desaparecidos <- migrantes_desaparecidos |> #Extrae países y causas de muerte\n  mutate(\n    country_of_death = countrycode(location_of_death,\n                          origin = 'country.name',\n                          destination = 'country.name'),\n    cause_of_death = str_extract(cause_of_death, \"^[^/]+\"),\n    region = str_extract(region, \n                         \"Asia|America|Africa|Europe|Caribbean|Mediterranean\"),\n    region = str_replace(region, \"Caribbean\", \"America\")\n  )\nmigrantes_desaparecidos$cause_of_death <- as.factor(migrantes_desaparecidos$cause_of_death)\nmigrantes_desaparecidos$region <- as.factor(migrantes_desaparecidos$region)\nmigrantes_desaparecidos$country_of_death <- as.factor(migrantes_desaparecidos$country_of_death)\nts_muertes <- migrantes_desaparecidos |>\n  group_by(year) |>\n  summarise(\n    muertes = sum(number_dead, na.rm = TRUE)\n  )\n\nts_muertes <- ts(ts_muertes$muertes, start = min(ts_muertes$year), end = max(ts_muertes$year), frequency = 1)\n\nglimpse(migrantes_desaparecidos)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 11,341\nColumns: 17\n$ incident_id                         <chr> \"2014.MMP00001\", \"2014.MMP00002\", ~\n$ region                              <fct> America, America, America, America~\n$ incident_date                       <date> 2014-01-06, 2014-01-12, 2014-01-1~\n$ year                                <dbl> 2014, 2014, 2014, 2014, 2014, 2014~\n$ number_dead                         <dbl> 1, 1, 1, 1, 1, 1, 12, 1, 1, 1, 1, ~\n$ minimum_estimated_number_of_missing <dbl> NA, NA, NA, NA, 0, NA, NA, NA, NA,~\n$ number_of_survivors                 <dbl> NA, NA, NA, NA, 2, NA, NA, NA, NA,~\n$ number_of_females                   <dbl> NA, NA, NA, NA, NA, NA, 9, NA, NA,~\n$ number_of_males                     <dbl> 1, NA, NA, 1, 1, NA, NA, NA, NA, N~\n$ number_of_children                  <dbl> NA, NA, NA, NA, NA, NA, 3, NA, NA,~\n$ cause_of_death                      <fct> Mixed or unknown, Mixed or unknown~\n$ location_of_death                   <chr> \"Pima Country Office of the Medica~\n$ latitud                             <dbl> 31.650259, 31.597130, 31.940260, 3~\n$ longitud                            <dbl> -110.3665, -111.7376, -113.0113, -~\n$ migrantion_route                    <chr> \"US-Mexico border crossing\", \"US-M~\n$ source_quality                      <dbl> 5, 5, 5, 5, 1, 5, 5, 5, 5, 5, 5, 5~\n$ country_of_death                    <fct> United States, United States, Unit~\n```\n\n\n:::\n\n```{.r .cell-code}\nglimpse(ts_muertes)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n Time-Series [1:9] from 2014 to 2022: 1752 4077 4071 3664 3176 ...\n```\n\n\n:::\n:::\n\n\n\n\n\n\n\n\nPrimero se observan algunos patrones o tendencias:\n\n\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(ts_muertes, main=\"Muertes por año\", xlab=\"Año\", ylab=\"Muertes\", col=\"darkblue\", type=\"l\")\n```\n\n::: {.cell-output-display}\n![](bitacora-3_files/figure-pdf/unnamed-chunk-2-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n\n\n\n\n\nUtilizando la prueba de Dickey-Fuller aumentada se observa si la serie temporal es estacionaria:\n\n\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tseries)\nadf.test(ts_muertes)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tAugmented Dickey-Fuller Test\n\ndata:  ts_muertes\nDickey-Fuller = -2.9157, Lag order = 2, p-value = 0.2236\nalternative hypothesis: stationary\n```\n\n\n:::\n:::\n\n\n\n\n\n\n\n\nNote que la serie no es estacionaria, pues p-value > 0.05, entonces se procede a diferenciarla:\n\n\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndiff_muertes <- diff(ts_muertes)\nplot(diff_muertes, main = \"Serie temporal diferenciada\", col = \"darkred\")\n```\n\n::: {.cell-output-display}\n![](bitacora-3_files/figure-pdf/unnamed-chunk-4-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n\n\n\n\n\nAhora se ajusta el modelo ARIMA, donde se utilizará la función auto.arima() del parquete **forecast** para un mejor manejo de los parámetros AR, I y MA de la serie:\n\n\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(forecast)\nmodelo_arima <- auto.arima(ts_muertes)\nsummary(modelo_arima)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nSeries: ts_muertes \nARIMA(0,0,0) with non-zero mean \n\nCoefficients:\n           mean\n      3027.6667\ns.e.   323.9503\n\nsigma^2 = 1062543:  log likelihood = -74.68\nAIC=153.37   AICc=155.37   BIC=153.76\n\nTraining set error measures:\n                       ME     RMSE      MAE      MPE     MAPE      MASE\nTraining set 6.063545e-13 971.8449 851.5556 -16.6233 38.94371 0.8189018\n                   ACF1\nTraining set -0.0912454\n```\n\n\n:::\n:::\n\n\n\n\n\n\n\nFinalmente utilizamos la funión forecast() para realizar las predicciones en los próximos 5 años sobre las muertes de migrantes desaparecidos:\n\n\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nprediccion_muertes <- forecast(modelo_arima, h=5)\nplot(prediccion_muertes, main=\"Predicción de muertes de migrantes para los próximos 5 años\")\n```\n\n::: {.cell-output-display}\n![](bitacora-3_files/figure-pdf/unnamed-chunk-6-1.pdf){fig-pos='H'}\n:::\n:::",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {
      "knitr": [
        "{\"type\":\"list\",\"attributes\":{},\"value\":[]}"
      ]
    },
    "preserve": null,
    "postProcess": false
  }
}